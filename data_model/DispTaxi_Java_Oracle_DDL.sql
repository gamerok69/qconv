-- Generated by Oracle SQL Developer Data Modeler 4.0.3.853
--   at:        2015-03-14 05:20:07 BRT
--   site:      Oracle9i
--   type:      Oracle9i




CREATE TABLE APP_ROLE
  (
    ID    INTEGER NOT NULL ,
    NAME  VARCHAR2 (30) NOT NULL ,
    DESCR VARCHAR2 (200)
  )
  LOGGING ;
COMMENT ON TABLE APP_ROLE
IS
  'Роли приложения' ;
  COMMENT ON COLUMN APP_ROLE.ID
IS
  'PK' ;
  COMMENT ON COLUMN APP_ROLE.NAME
IS
  'Имя роли' ;
  COMMENT ON COLUMN APP_ROLE.DESCR
IS
  'Описание обязанностей, прав роли' ;
  ALTER TABLE APP_ROLE ADD CONSTRAINT APP_ROLE_PK PRIMARY KEY ( ID ) ;
  ALTER TABLE APP_ROLE ADD CONSTRAINT APP_ROLE_UK UNIQUE ( NAME ) ;

CREATE TABLE AUTO
  (
    ID           INTEGER NOT NULL ,
    CAR_ID       INTEGER NOT NULL ,
    DRIVER_ID    INTEGER NOT NULL ,
    R_WAITING    SMALLINT ,
    R_ROUTE      SMALLINT ,
    POSITION_LAT SMALLINT ,
    POSITION_LNG SMALLINT ,
    SIGN_ACTIVE  INTEGER ,
    D_CREATE     DATE
  )
  LOGGING ;
COMMENT ON TABLE AUTO
IS
  'Список автомобилей готовых к выполнению заказов' ;
  COMMENT ON COLUMN AUTO.ID
IS
  'PK' ;
  COMMENT ON COLUMN AUTO.CAR_ID
IS
  'FK cars' ;
  COMMENT ON COLUMN AUTO.DRIVER_ID
IS
  'FK drivers' ;
  COMMENT ON COLUMN AUTO.R_WAITING
IS
  'Радиус ожидания, км' ;
  COMMENT ON COLUMN AUTO.R_ROUTE
IS
  'Радиус выполнения заказа, км' ;
  COMMENT ON COLUMN AUTO.POSITION_LAT
IS
  'Текущее положение авто (широта)' ;
  COMMENT ON COLUMN AUTO.POSITION_LNG
IS
  'Текущее положение авто (долгота)' ;
  COMMENT ON COLUMN AUTO.SIGN_ACTIVE
IS
  'Признак участия в исполнении заказа' ;
  COMMENT ON COLUMN AUTO.D_CREATE
IS
  'Дата создания записи' ;
  ALTER TABLE AUTO ADD CONSTRAINT AUTO_PK PRIMARY KEY ( ID ) ;
  ALTER TABLE AUTO ADD CONSTRAINT AUTO_UK UNIQUE ( CAR_ID , DRIVER_ID ) ;

CREATE TABLE CAR
  (
    ID               INTEGER CONSTRAINT NNC_cars_id_car NOT NULL ,
    REG_NUM          VARCHAR2 (10) ,
    SEATS_QUAN       INTEGER NOT NULL ,
    CHILD_SEATS_QUAN INTEGER ,
    CAR_TYPE_ID      INTEGER NOT NULL ,
    SIGN_ACTIVE      INTEGER ,
    D_CREATE         DATE
  )
  LOGGING ;
COMMENT ON TABLE CAR
IS
  'Справочник транспортных средств' ;
  COMMENT ON COLUMN CAR.ID
IS
  'PK' ;
  COMMENT ON COLUMN CAR.REG_NUM
IS
  'Регистрационный номер' ;
  COMMENT ON COLUMN CAR.SEATS_QUAN
IS
  'Количество пассажирских мест' ;
  COMMENT ON COLUMN CAR.CHILD_SEATS_QUAN
IS
  'Кол-во детских сидений' ;
  COMMENT ON COLUMN CAR.CAR_TYPE_ID
IS
  'Тип авто' ;
  COMMENT ON COLUMN CAR.SIGN_ACTIVE
IS
  'Признак используемости авто' ;
  COMMENT ON COLUMN CAR.D_CREATE
IS
  'Дата создания записи' ;
  ALTER TABLE CAR ADD CONSTRAINT CAR_PK PRIMARY KEY ( ID ) ;
  ALTER TABLE CAR ADD CONSTRAINT CAR_UK UNIQUE ( REG_NUM ) ;

CREATE TABLE CAR_TYPE
  (
    ID            INTEGER NOT NULL ,
    CAR_TYPE_NAME VARCHAR2 (30)
  )
  LOGGING ;
COMMENT ON TABLE CAR_TYPE
IS
  'Типы авто' ;
  COMMENT ON COLUMN CAR_TYPE.ID
IS
  'PK' ;
  COMMENT ON COLUMN CAR_TYPE.CAR_TYPE_NAME
IS
  'Название типа' ;
  ALTER TABLE CAR_TYPE ADD CONSTRAINT CAR_TYPES_PK PRIMARY KEY ( ID ) ;

CREATE TABLE CITY
  ( ID INTEGER NOT NULL , NAME VARCHAR2 (50)
  ) LOGGING ;
COMMENT ON TABLE CITY
IS
  'Справочник населённых пунктов' ;
  COMMENT ON COLUMN CITY.ID
IS
  'PK' ;
  COMMENT ON COLUMN CITY.NAME
IS
  'Название населённого пункта' ;
  CREATE INDEX CITY_UK ON CITY
    ( NAME ASC
    ) ;
  ALTER TABLE CITY ADD CONSTRAINT CITIES_PK PRIMARY KEY ( ID ) ;

CREATE TABLE CUSTOMER
  (
    ID          INTEGER CONSTRAINT NNC_DRIVERSv1_ID_DRIVER NOT NULL ,
    AVG_RATING  INTEGER ,
    SIGN_ACTIVE INTEGER ,
    D_CREATE    DATE
  )
  LOGGING ;
COMMENT ON TABLE CUSTOMER
IS
  'Справочник заказчиков' ;
  COMMENT ON COLUMN CUSTOMER.ID
IS
  'PK' ;
  COMMENT ON COLUMN CUSTOMER.AVG_RATING
IS
  'Средняя оценка заказчику' ;
  COMMENT ON COLUMN CUSTOMER.SIGN_ACTIVE
IS
  'Признак активности водителя в системе' ;
  COMMENT ON COLUMN CUSTOMER.D_CREATE
IS
  'Дата создания записи' ;
  ALTER TABLE CUSTOMER ADD CONSTRAINT CUSTOMER_PK PRIMARY KEY ( ID ) ;

CREATE TABLE DRIVER
  (
    ID          INTEGER NOT NULL ,
    AVG_RATING  INTEGER ,
    SIGN_ACTIVE INTEGER ,
    D_CREATE    DATE
  )
  LOGGING ;
COMMENT ON TABLE DRIVER
IS
  'Справочник водителей' ;
  COMMENT ON COLUMN DRIVER.ID
IS
  'PK' ;
  COMMENT ON COLUMN DRIVER.AVG_RATING
IS
  'Средняя оценка водителю' ;
  COMMENT ON COLUMN DRIVER.SIGN_ACTIVE
IS
  'Признак активности водителя в системе' ;
  COMMENT ON COLUMN DRIVER.D_CREATE
IS
  'Дата создания записи' ;
  ALTER TABLE DRIVER ADD CONSTRAINT DRIVER_PK PRIMARY KEY ( ID ) ;

CREATE TABLE "ORDER"
  (
    ID              INTEGER NOT NULL ,
    CUSTOMER_ID     INTEGER NOT NULL ,
    ROUTE_ID        INTEGER NOT NULL ,
    AUTO_ID         INTEGER ,
    ORDERS_STATE_ID INTEGER NOT NULL ,
    RESULT_ID       INTEGER NOT NULL ,
    ROUTE_LENGTH    INTEGER ,
    ORDER_PRICE     INTEGER ,
    CUSTOMER_RATING INTEGER ,
    DRIVER_RATING   INTEGER ,
    D_CREATE        DATE NOT NULL
  )
  LOGGING ;
COMMENT ON TABLE "ORDER"
IS
  'Заказы' ;
  COMMENT ON COLUMN "ORDER".ID
IS
  'PK' ;
  COMMENT ON COLUMN "ORDER".CUSTOMER_ID
IS
  'Заказчик' ;
  COMMENT ON COLUMN "ORDER".ROUTE_ID
IS
  'Маршрут следования' ;
  COMMENT ON COLUMN "ORDER".AUTO_ID
IS
  'Исполнитель заказа' ;
  COMMENT ON COLUMN "ORDER".ORDERS_STATE_ID
IS
  'Состояние заказа: новый, принят, ожидание пассажира, выполнен' ;
  COMMENT ON COLUMN "ORDER".RESULT_ID
IS
  'Результат: заказ принят, заказ выполнен, заказ отменён' ;
  COMMENT ON COLUMN "ORDER".ROUTE_LENGTH
IS
  'Длина маршрута' ;
  COMMENT ON COLUMN "ORDER".ORDER_PRICE
IS
  'Стоимость заказа' ;
  COMMENT ON COLUMN "ORDER".CUSTOMER_RATING
IS
  'Оценка заказчику' ;
  COMMENT ON COLUMN "ORDER".DRIVER_RATING
IS
  'Оценка водителю' ;
  COMMENT ON COLUMN "ORDER".D_CREATE
IS
  'Дата создания записи' ;
  ALTER TABLE "ORDER" ADD CONSTRAINT ORDERS_PK PRIMARY KEY ( ID ) ;

CREATE TABLE ORDERS_RESULT
  (
    ID    INTEGER NOT NULL ,
    NAME  VARCHAR2 (50) NOT NULL ,
    DESCR VARCHAR2 (200)
  )
  LOGGING ;
COMMENT ON TABLE ORDERS_RESULT
IS
  'Результат исполнения заказа' ;
  COMMENT ON COLUMN ORDERS_RESULT.ID
IS
  'PK' ;
  COMMENT ON COLUMN ORDERS_RESULT.NAME
IS
  'Наименование' ;
  ALTER TABLE ORDERS_RESULT ADD CONSTRAINT ORDER_RESULTS_PK PRIMARY KEY ( ID ) ;
  ALTER TABLE ORDERS_RESULT ADD CONSTRAINT ORDERS_RESULT_UK UNIQUE ( NAME ) ;

CREATE TABLE ORDERS_STATE
  (
    ID    INTEGER NOT NULL ,
    NAME  VARCHAR2 (30) ,
    DESCR VARCHAR2 (100)
  )
  LOGGING ;
COMMENT ON TABLE ORDERS_STATE
IS
  'Состояния заказа' ;
  COMMENT ON COLUMN ORDERS_STATE.ID
IS
  'PK' ;
  COMMENT ON COLUMN ORDERS_STATE.NAME
IS
  'Описание состояния заказа' ;
  COMMENT ON COLUMN ORDERS_STATE.DESCR
IS
  'Подробное описание' ;
  ALTER TABLE ORDERS_STATE ADD CONSTRAINT ORDERS_STATE_PK PRIMARY KEY ( ID ) ;
  ALTER TABLE ORDERS_STATE ADD CONSTRAINT ORDERS_STATE_UK UNIQUE ( NAME ) ;

CREATE TABLE ORDERS_TIMETABLE
  (
    ID              INTEGER NOT NULL ,
    ORDER_ID        INTEGER NOT NULL ,
    ORDERS_STATE_ID INTEGER NOT NULL ,
    D_CREATE        DATE
  )
  LOGGING ;
COMMENT ON TABLE ORDERS_TIMETABLE
IS
  'График выполнения заказа' ;
  COMMENT ON COLUMN ORDERS_TIMETABLE.ID
IS
  'PK' ;
  COMMENT ON COLUMN ORDERS_TIMETABLE.ORDER_ID
IS
  'ID заказа' ;
  COMMENT ON COLUMN ORDERS_TIMETABLE.ORDERS_STATE_ID
IS
  'Состояние заказа' ;
  COMMENT ON COLUMN ORDERS_TIMETABLE.D_CREATE
IS
  'Дата проставления состояния' ;
  ALTER TABLE ORDERS_TIMETABLE ADD CONSTRAINT ORADERS_TIMETABLE_PK PRIMARY KEY ( ID ) ;

CREATE TABLE PERSON
  (
    ID         INTEGER NOT NULL ,
    FIRST_NAME VARCHAR2 (30) NOT NULL ,
    LAST_NAME  VARCHAR2 (30) ,
    TEL_NUM    VARCHAR2 (30) NOT NULL ,
    D_CREATE   DATE
  )
  LOGGING ;
COMMENT ON TABLE PERSON
IS
  'Справочник персон' ;
  COMMENT ON COLUMN PERSON.ID
IS
  'PK' ;
  COMMENT ON COLUMN PERSON.FIRST_NAME
IS
  'Имя' ;
  COMMENT ON COLUMN PERSON.LAST_NAME
IS
  'Фамилия' ;
  COMMENT ON COLUMN PERSON.TEL_NUM
IS
  'Контактный телефон' ;
  COMMENT ON COLUMN PERSON.D_CREATE
IS
  'Дата создания записи' ;
  ALTER TABLE PERSON ADD CONSTRAINT PERSON_PK PRIMARY KEY ( ID ) ;
  ALTER TABLE PERSON ADD CONSTRAINT PERSON_UK UNIQUE ( TEL_NUM ) ;

CREATE TABLE POINT
  (
    ID        INTEGER NOT NULL ,
    STREET_ID INTEGER NOT NULL ,
    HOUSE_NUM VARCHAR2 (10) ,
    HOUSE_LOC INTEGER ,
    POINT_LAT SMALLINT ,
    POINT_LNG SMALLINT
  )
  LOGGING ;
COMMENT ON TABLE POINT
IS
  'Справочник пунктов назначений' ;
  COMMENT ON COLUMN POINT.ID
IS
  'PK' ;
  COMMENT ON COLUMN POINT.STREET_ID
IS
  'FK Улица' ;
  COMMENT ON COLUMN POINT.HOUSE_NUM
IS
  'Номер дома/корпуса' ;
  COMMENT ON COLUMN POINT.HOUSE_LOC
IS
  'Номер подъезда' ;
  COMMENT ON COLUMN POINT.POINT_LAT
IS
  'Положение на карте: Широта [-90, 90]' ;
  COMMENT ON COLUMN POINT.POINT_LNG
IS
  'Положение на карте: Долгота [-180, 180]' ;
  ALTER TABLE POINT ADD CONSTRAINT POINTS_PK PRIMARY KEY ( ID ) ;
  ALTER TABLE POINT ADD CONSTRAINT POINT_UK UNIQUE ( STREET_ID , HOUSE_NUM , HOUSE_LOC ) ;

CREATE TABLE PRICE
  (
    ID          INTEGER NOT NULL ,
    CAR_TYPE_ID INTEGER NOT NULL ,
    COST_BEFORE INTEGER ,
    COST_KM     INTEGER ,
    D_BEGIN     DATE ,
    D_END       DATE ,
    D_CREATE    DATE
  )
  LOGGING ;
COMMENT ON TABLE PRICE
IS
  'Цены на услуги' ;
  COMMENT ON COLUMN PRICE.ID
IS
  'PK' ;
  COMMENT ON COLUMN PRICE.CAR_TYPE_ID
IS
  'Тип авто' ;
  COMMENT ON COLUMN PRICE.COST_BEFORE
IS
  'Цена посадки' ;
  COMMENT ON COLUMN PRICE.COST_KM
IS
  'Цена за 1 км' ;
  COMMENT ON COLUMN PRICE.D_BEGIN
IS
  'Действует с' ;
  COMMENT ON COLUMN PRICE.D_END
IS
  'Действует по' ;
  COMMENT ON COLUMN PRICE.D_CREATE
IS
  'Дата создания' ;
  ALTER TABLE PRICE ADD CONSTRAINT PRICE_PK PRIMARY KEY ( ID ) ;

CREATE TABLE ROUTE
  (
    ID           INTEGER NOT NULL ,
    SRC_POINT_ID INTEGER NOT NULL ,
    DST_POINT_ID INTEGER NOT NULL ,
    EST_LENGTH   INTEGER ,
    FACT_LENGTH  INTEGER ,
    EST_TIME     INTEGER
  )
  LOGGING ;
COMMENT ON TABLE ROUTE
IS
  'Маршрут следования' ;
  COMMENT ON COLUMN ROUTE.ID
IS
  'PK' ;
  COMMENT ON COLUMN ROUTE.SRC_POINT_ID
IS
  'Начальный пункт' ;
  COMMENT ON COLUMN ROUTE.DST_POINT_ID
IS
  'Конечный пункт' ;
  COMMENT ON COLUMN ROUTE.EST_LENGTH
IS
  'Планируемая Длина пути' ;
  COMMENT ON COLUMN ROUTE.FACT_LENGTH
IS
  'Фактическая Длина пути' ;
  COMMENT ON COLUMN ROUTE.EST_TIME
IS
  'Планируемое время (минут)' ;
  ALTER TABLE ROUTE ADD CONSTRAINT ROUTES_PK PRIMARY KEY ( ID ) ;

CREATE TABLE STREET
  (
    ID      INTEGER NOT NULL ,
    NAME    VARCHAR2 (50) ,
    CITY_ID INTEGER NOT NULL
  )
  LOGGING ;
COMMENT ON TABLE STREET
IS
  'Справочник улиц' ;
  COMMENT ON COLUMN STREET.ID
IS
  'PK' ;
  COMMENT ON COLUMN STREET.NAME
IS
  'Название улицы' ;
  COMMENT ON COLUMN STREET.CITY_ID
IS
  'FK Населённый пункт' ;
  ALTER TABLE STREET ADD CONSTRAINT STREET_PK PRIMARY KEY ( ID ) ;
  ALTER TABLE STREET ADD CONSTRAINT STREET_UK UNIQUE ( CITY_ID , NAME ) ;

CREATE TABLE USERS_ACCOUNT
  (
    ID          INTEGER NOT NULL ,
    NAME        VARCHAR2 (30) NOT NULL ,
    PASSW       VARCHAR2 (30) NOT NULL ,
    EMAIL       VARCHAR2 (50) ,
    APP_ROLE_ID INTEGER NOT NULL ,
    PERSONE_ID  INTEGER NOT NULL ,
    SIGN_ACTIVE INTEGER ,
    D_CREATE    DATE
  )
  LOGGING ;
COMMENT ON TABLE USERS_ACCOUNT
IS
  'Справочник аккаунтов' ;
  COMMENT ON COLUMN USERS_ACCOUNT.ID
IS
  'PK' ;
  COMMENT ON COLUMN USERS_ACCOUNT.NAME
IS
  'Логин пользователя' ;
  COMMENT ON COLUMN USERS_ACCOUNT.PASSW
IS
  'Пароль' ;
  COMMENT ON COLUMN USERS_ACCOUNT.EMAIL
IS
  'Контактный email' ;
  COMMENT ON COLUMN USERS_ACCOUNT.APP_ROLE_ID
IS
  'Роль пользователя' ;
  COMMENT ON COLUMN USERS_ACCOUNT.PERSONE_ID
IS
  'ID персоны' ;
  COMMENT ON COLUMN USERS_ACCOUNT.SIGN_ACTIVE
IS
  'Признак активности' ;
  COMMENT ON COLUMN USERS_ACCOUNT.D_CREATE
IS
  'Дата создания' ;
  ALTER TABLE USERS_ACCOUNT ADD CONSTRAINT USERS_ACCOUNT_PK PRIMARY KEY ( ID ) ;
  ALTER TABLE USERS_ACCOUNT ADD CONSTRAINT USERS_ACCOUNT_UK UNIQUE ( NAME ) ;

ALTER TABLE AUTO ADD CONSTRAINT AUTO_CAR_FK FOREIGN KEY ( CAR_ID ) REFERENCES CAR ( ID ) ;

ALTER TABLE AUTO ADD CONSTRAINT AUTO_DRIVER_FK FOREIGN KEY ( DRIVER_ID ) REFERENCES DRIVER ( ID ) ;

ALTER TABLE CAR ADD CONSTRAINT CAR_CAR_TYPE_FK FOREIGN KEY ( CAR_TYPE_ID ) REFERENCES CAR_TYPE ( ID ) ;

ALTER TABLE CUSTOMER ADD CONSTRAINT CUSTOMER_PERSON_FK FOREIGN KEY ( ID ) REFERENCES PERSON ( ID ) ;

ALTER TABLE DRIVER ADD CONSTRAINT DRIVER_PERSON_FK FOREIGN KEY ( ID ) REFERENCES PERSON ( ID ) ;

ALTER TABLE ORDERS_TIMETABLE ADD CONSTRAINT ORADERS_TIMETABLE_ORDER_FK FOREIGN KEY ( ORDER_ID ) REFERENCES "ORDER" ( ID ) ;

ALTER TABLE ORDERS_TIMETABLE ADD CONSTRAINT ORADERS_TIMETABLE_STATE_FK FOREIGN KEY ( ORDERS_STATE_ID ) REFERENCES ORDERS_STATE ( ID ) ;

ALTER TABLE "ORDER" ADD CONSTRAINT ORDER_AUTO_FK FOREIGN KEY ( AUTO_ID ) REFERENCES AUTO ( ID ) ;

ALTER TABLE "ORDER" ADD CONSTRAINT ORDER_CUSTOMER_FK FOREIGN KEY ( CUSTOMER_ID ) REFERENCES CUSTOMER ( ID ) ;

ALTER TABLE "ORDER" ADD CONSTRAINT ORDER_ORDERS_RESULT_FK FOREIGN KEY ( RESULT_ID ) REFERENCES ORDERS_RESULT ( ID ) ;

ALTER TABLE "ORDER" ADD CONSTRAINT ORDER_ORDERS_STATE_FK FOREIGN KEY ( ORDERS_STATE_ID ) REFERENCES ORDERS_STATE ( ID ) ;

ALTER TABLE "ORDER" ADD CONSTRAINT ORDER_ROUTE_FK FOREIGN KEY ( ROUTE_ID ) REFERENCES ROUTE ( ID ) ;

ALTER TABLE POINT ADD CONSTRAINT POINTS_STREETS_FK FOREIGN KEY ( STREET_ID ) REFERENCES STREET ( ID ) ;

ALTER TABLE PRICE ADD CONSTRAINT PRICE_CAR_TYPE_FK FOREIGN KEY ( CAR_TYPE_ID ) REFERENCES CAR_TYPE ( ID ) ;

ALTER TABLE ROUTE ADD CONSTRAINT ROUTE_POINT_DST_FK FOREIGN KEY ( DST_POINT_ID ) REFERENCES POINT ( ID ) ;

ALTER TABLE ROUTE ADD CONSTRAINT ROUTE_POINT_SRC_FK FOREIGN KEY ( SRC_POINT_ID ) REFERENCES POINT ( ID ) ;

ALTER TABLE STREET ADD CONSTRAINT STREET_CITY_FK FOREIGN KEY ( CITY_ID ) REFERENCES CITY ( ID ) ;

ALTER TABLE USERS_ACCOUNT ADD CONSTRAINT USERS_ACCOUNT_APP_ROLE_FK FOREIGN KEY ( APP_ROLE_ID ) REFERENCES APP_ROLE ( ID ) ;

ALTER TABLE USERS_ACCOUNT ADD CONSTRAINT USERS_ACCOUNT_PERSON_FK FOREIGN KEY ( PERSONE_ID ) REFERENCES PERSON ( ID ) ;


-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                            17
-- CREATE INDEX                             1
-- ALTER TABLE                             45
-- CREATE VIEW                              0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
